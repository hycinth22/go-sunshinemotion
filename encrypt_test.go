package lib

import (
	"testing"
)

func TestEncodeBZ(t *testing.T) {
	data := map[string]string{
		"":   "3B6AD1E96C13F8C893CA9A649313DD13",
		"[]": "CEC0CC216B9DB5288E5A9ED306BA2525",
		"[1544338246, xposed, root, Android,19,4.4.2, 354730010542250, 460075422517361]": "9456B81E71B9A52E39AECEF0AFD6A871EA8D9726E1121BC4633635D39958F6B31483F1DA46D1FF9314004637866754AD50AD1FB2911B66DB28B35306C208E683A5D4D250B1EFEE26409E35F4206AB9E067475254294B75F05171A095C3063647F679410A9EB6074D6495BB40EC634ED1",
		"[1544345190, Android,24,7.0, 865964032623895, 460110101098930]":                 "4F9F4360340CB760BDA9751E5BC14BFB4E3FB012E80F310AF964BACA1C908E35450C22423DA0912F4F1C41188C88E96B552623AAE02C0860A08E01B6273E6447E976041C761485D22633BE9335C5E6951CC2B0FA5A7A02E49668B802656E957A",
	}
	for k, v := range data {
		bz := EncodeBZ(k)
		t.Log(k, bz, len(bz))
		if bz != v {
			t.FailNow()
		}
	}
}

func TestDecodeBZ(t *testing.T) {
	data := map[string]string{
		"3B6AD1E96C13F8C893CA9A649313DD13": "",
		"CEC0CC216B9DB5288E5A9ED306BA2525": "[]",
		"9456B81E71B9A52E39AECEF0AFD6A871EA8D9726E1121BC4633635D39958F6B31483F1DA46D1FF9314004637866754AD50AD1FB2911B66DB28B35306C208E683A5D4D250B1EFEE26409E35F4206AB9E067475254294B75F05171A095C3063647F679410A9EB6074D6495BB40EC634ED1": "[1544338246, xposed, root, Android,19,4.4.2, 354730010542250, 460075422517361]",
		"4F9F4360340CB760BDA9751E5BC14BFB4E3FB012E80F310AF964BACA1C908E35450C22423DA0912F4F1C41188C88E96B552623AAE02C0860A08E01B6273E6447E976041C761485D22633BE9335C5E6951CC2B0FA5A7A02E49668B802656E957A":                                 "[1544345190, Android,24,7.0, 865964032623895, 460110101098930]",
	}
	for k, v := range data {
		bz, err := DecodeBZ(k)
		t.Log(bz, len(bz), err)
		if bz != v {
			t.FailNow()
		}
	}
}
